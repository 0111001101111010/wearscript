<html style="width:100%; height:100%; overflow:hidden">
<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.0/zepto.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js"></script>
<script src="glassgap.js"></script>
</head>
<body style="width:100%; height:100%; overflow:hidden; margin:0">
<canvas id="canvas" width="427" height="240" style="display:block">
</canvas>
<script>

function cb(data) {
    if (data.type != 4)
        return;
    if (_.has(window, 'prevValue')) {
        var d = data.values;
        d = d[0] * d[0] + d[1] * d[1] + d[2] * d[2];
        GG.log(String(d));
        if (d > 1)
            randomColor();
    }
    prevValue = data.values;
}

function randomColor() {
    var ctx = $('#canvas')[0].getContext("2d");
    ctx.fillStyle = _.sample(["#E9003a", "#FF5300", "#00AB6F", "#58E000"])
    ctx.fillRect(0, 0, 427, 240);
}

$(function () {
    if (!_.has(window, 'GG'))
        GG = new GlassGapSimulator();
    GG.displayWebView();
    randomColor();
    GG.sensorOn(4);
    GG.sensorCallback('cb');
});
</script>
</body>
</html>
